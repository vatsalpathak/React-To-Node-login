{"version":3,"file":"okta-react.cjs.js","sources":["../../src/OktaContext.ts","../../src/OktaError.tsx","../../src/Security.tsx","../../src/withOktaAuth.tsx","../../src/LoginCallback.tsx","../../src/SecureRoute.tsx"],"sourcesContent":["/*\n * Copyright (c) 2020-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport * as React from 'react';\nimport { AuthState, OktaAuth } from '@okta/okta-auth-js';\n\nexport type OnAuthRequiredFunction = (oktaAuth: OktaAuth) => Promise<void> | void;\nexport type OnAuthResumeFunction = () => void;\n\nexport type RestoreOriginalUriFunction = (oktaAuth: OktaAuth, originalUri: string) => Promise<void> | void;\n\nexport interface IOktaContext {\n    oktaAuth: OktaAuth;\n    authState: AuthState | null;\n    _onAuthRequired?: OnAuthRequiredFunction;\n}\n\nconst OktaContext = React.createContext<IOktaContext | null>(null);\n\nexport const useOktaAuth = (): IOktaContext => React.useContext(OktaContext) as IOktaContext;\n\nexport default OktaContext;\n","/*\n * Copyright (c) 2020-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport * as React from 'react';\n\nconst OktaError: React.FC<{ error: Error }> = ({ error }) => { \n  if(error.name && error.message) { \n    return <p>{error.name}: {error.message}</p>;\n  }\n  return <p>Error: {error.toString()}</p>;\n};\n\nexport default OktaError;\n","/*!\n * Copyright (c) 2017-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport * as React from 'react';\nimport { AuthSdkError, AuthState, OktaAuth } from '@okta/okta-auth-js';\nimport OktaContext, { OnAuthRequiredFunction, RestoreOriginalUriFunction } from './OktaContext';\nimport OktaError from './OktaError';\nimport { compare as compareVersions } from 'compare-versions';\n\ndeclare const AUTH_JS: {\n  minSupportedVersion: string;\n}\n\ndeclare const PACKAGE_NAME: string;\ndeclare const PACKAGE_VERSION: string;\ndeclare const SKIP_VERSION_CHECK: string;\n\nconst Security: React.FC<{\n  oktaAuth: OktaAuth,\n  restoreOriginalUri: RestoreOriginalUriFunction, \n  onAuthRequired?: OnAuthRequiredFunction,\n  children?: React.ReactNode\n} & React.HTMLAttributes<HTMLDivElement>> = ({ \n  oktaAuth,\n  restoreOriginalUri, \n  onAuthRequired, \n  children\n}) => { \n  const [authState, setAuthState] = React.useState(() => {\n    if (!oktaAuth) {\n      return null;\n    }\n    return oktaAuth.authStateManager.getAuthState();\n  });\n\n  React.useEffect(() => {\n    if (!oktaAuth || !restoreOriginalUri) {\n      return;\n    }\n\n    // Add default restoreOriginalUri callback\n    // props.restoreOriginalUri is required, therefore if options.restoreOriginalUri exists, there are 2 callbacks\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    if (oktaAuth.options.restoreOriginalUri) {\n      console.warn('Two custom restoreOriginalUri callbacks are detected. The one from the OktaAuth configuration will be overridden by the provided restoreOriginalUri prop from the Security component.');\n    }\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    oktaAuth.options.restoreOriginalUri = (async (oktaAuth: unknown, originalUri: string) => {\n      restoreOriginalUri(oktaAuth as OktaAuth, originalUri);\n    }) as ((oktaAuth: OktaAuth, originalUri?: string) => Promise<void>);\n\n  }, []); // empty array, only check on component mount\n\n  React.useEffect(() => {\n    if (!oktaAuth) {\n      return;\n    }\n\n    // Add okta-react userAgent\n    if (oktaAuth._oktaUserAgent) {\n      oktaAuth._oktaUserAgent.addEnvironment(`${PACKAGE_NAME}/${PACKAGE_VERSION}`);\n    } else {\n      console.warn('_oktaUserAgent is not available on auth SDK instance. Please use okta-auth-js@^5.3.1 .');\n    }\n\n    // Update Security provider with latest authState\n    const currentAuthState = oktaAuth.authStateManager.getAuthState();\n    if (currentAuthState !== authState) {\n      setAuthState(currentAuthState);\n    }\n    const handler = (authState: AuthState) => {\n      setAuthState(authState);\n    };\n    oktaAuth.authStateManager.subscribe(handler);\n\n    // Trigger an initial change event to make sure authState is latest\n    oktaAuth.start();\n\n    return () => {\n      oktaAuth.authStateManager.unsubscribe(handler);\n    };\n  }, [oktaAuth]);\n\n  if (!oktaAuth) {\n    const err = new AuthSdkError('No oktaAuth instance passed to Security Component.');\n    return <OktaError error={err} />;\n  }\n\n  if (!restoreOriginalUri) {\n    const err = new AuthSdkError('No restoreOriginalUri callback passed to Security Component.');\n    return <OktaError error={err} />;\n  }\n\n  if (!oktaAuth._oktaUserAgent) {\n    console.warn('_oktaUserAgent is not available on auth SDK instance. Please use okta-auth-js@^5.3.1 .');\n  }\n  else {\n    // use SKIP_VERSION_CHECK flag to control version check in tests\n    // OKTA-465157: remove SKIP_VERSION_CHECK\n    const isAuthJsSupported = SKIP_VERSION_CHECK === '1' ||\n      compareVersions(oktaAuth._oktaUserAgent.getVersion(), AUTH_JS.minSupportedVersion, '>=');\n    if (!isAuthJsSupported) {\n      const err = new AuthSdkError(`\n        Passed in oktaAuth is not compatible with the SDK,\n        minimum supported okta-auth-js version is ${AUTH_JS.minSupportedVersion}.\n      `);\n      return <OktaError error={err} />;\n    }\n  }\n\n  return (\n    <OktaContext.Provider value={{ \n      oktaAuth, \n      authState, \n      _onAuthRequired: onAuthRequired\n    }}>\n      {children}\n    </OktaContext.Provider>\n  );\n};\n\nexport default Security;\n","/*\n * Copyright (c) 2020-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport * as React from 'react';\nimport { useOktaAuth, IOktaContext } from './OktaContext';\n\nconst withOktaAuth = <P extends IOktaContext>(\n  ComponentToWrap: React.ComponentType<P>\n): React.FC<Omit<P, keyof IOktaContext>> => { \n  const WrappedComponent = (props: Omit<P, keyof IOktaContext>) => { \n    const oktaAuthProps = useOktaAuth();\n    return <ComponentToWrap {...oktaAuthProps as IOktaContext } {...props as P} />;\n  };\n  WrappedComponent.displayName = 'withOktaAuth_' + (ComponentToWrap.displayName || ComponentToWrap.name);\n  return WrappedComponent;\n};\n\nexport default withOktaAuth;\n","/*\n * Copyright (c) 2017-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport * as React from 'react';\nimport { useOktaAuth, OnAuthResumeFunction } from './OktaContext';\nimport OktaError from './OktaError';\n\ninterface LoginCallbackProps {\n  errorComponent?: React.ComponentType<{ error: Error }>;\n  onAuthResume?: OnAuthResumeFunction;\n  loadingElement?: React.ReactElement;\n}\n\nconst LoginCallback: React.FC<LoginCallbackProps> = ({ errorComponent, loadingElement = null, onAuthResume }) => { \n  const { oktaAuth, authState } = useOktaAuth();\n  const [callbackError, setCallbackError] = React.useState(null);\n\n  const ErrorReporter = errorComponent || OktaError;\n  React.useEffect(() => {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore OKTA-464505: backward compatibility support for auth-js@5\n    const isInteractionRequired = oktaAuth.idx.isInteractionRequired || oktaAuth.isInteractionRequired.bind(oktaAuth);\n    if (onAuthResume && isInteractionRequired()) {\n      onAuthResume();\n      return;\n    }\n    oktaAuth.handleLoginRedirect().catch(e => {\n      setCallbackError(e);\n    });\n  }, [oktaAuth]);\n\n  const authError = authState?.error;\n  const displayError = callbackError || authError;\n  if (displayError) { \n    return <ErrorReporter error={displayError}/>;\n  }\n\n  return loadingElement;\n};\n\nexport default LoginCallback;\n","/*\n * Copyright (c) 2017-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport * as React from 'react';\nimport { useOktaAuth, OnAuthRequiredFunction } from './OktaContext';\nimport * as ReactRouterDom from 'react-router-dom';\nimport { toRelativeUrl, AuthSdkError } from '@okta/okta-auth-js';\nimport OktaError from './OktaError';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nlet useMatch: any;\nif ('useRouteMatch' in ReactRouterDom) {\n  // trick static analyzer to avoid \"'useRouteMatch' is not exported\" error\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  useMatch = (ReactRouterDom as any)['useRouteMatch' in ReactRouterDom ? 'useRouteMatch' : ''];\n} else {\n  // throw when useMatch is triggered\n  useMatch = () => { \n    throw new AuthSdkError('Unsupported: SecureRoute only works with react-router-dom v5 or any router library with compatible APIs. See examples under the \"samples\" folder for how to implement your own custom SecureRoute Component.');\n  };\n}\n\nconst SecureRoute: React.FC<{\n  onAuthRequired?: OnAuthRequiredFunction;\n  errorComponent?: React.ComponentType<{ error: Error }>;\n} & ReactRouterDom.RouteProps & React.HTMLAttributes<HTMLDivElement>> = ({ \n  onAuthRequired,\n  errorComponent,\n  ...routeProps\n}) => { \n  const { oktaAuth, authState, _onAuthRequired } = useOktaAuth();\n  const match = useMatch(routeProps);\n  const pendingLogin = React.useRef(false);\n  const [handleLoginError, setHandleLoginError] = React.useState<Error | null>(null);\n  const ErrorReporter = errorComponent || OktaError;\n\n  React.useEffect(() => {\n    const handleLogin = async () => {\n      if (pendingLogin.current) {\n        return;\n      }\n\n      pendingLogin.current = true;\n\n      const originalUri = toRelativeUrl(window.location.href, window.location.origin);\n      oktaAuth.setOriginalUri(originalUri);\n      const onAuthRequiredFn = onAuthRequired || _onAuthRequired;\n      if (onAuthRequiredFn) {\n        await onAuthRequiredFn(oktaAuth);\n      } else {\n        await oktaAuth.signInWithRedirect();\n      }\n    };\n\n    // Only process logic if the route matches\n    if (!match) {\n      return;\n    }\n\n    if (!authState) {\n      return;\n    }\n\n    if (authState.isAuthenticated) {\n      pendingLogin.current = false;\n      return;\n    }\n\n    // Start login if app has decided it is not logged in and there is no pending signin\n    if(!authState.isAuthenticated) { \n      handleLogin().catch(err => {\n        setHandleLoginError(err as Error);\n      });\n    }  \n\n  }, [\n    authState,\n    oktaAuth, \n    match, \n    onAuthRequired, \n    _onAuthRequired\n  ]);\n\n  if (handleLoginError) {\n    return <ErrorReporter error={handleLoginError} />;\n  }\n\n  if (!authState || !authState.isAuthenticated) {\n    return null;\n  }\n\n  return (\n    <ReactRouterDom.Route\n      { ...routeProps }\n    />\n  );\n};\n\nexport default SecureRoute;\n"],"names":["OktaContext","React","createContext","useOktaAuth","useContext","OktaError","error","name","message","createElement","toString","Security","oktaAuth","restoreOriginalUri","onAuthRequired","children","useState","authStateManager","getAuthState","_slicedToArray","authState","setAuthState","useEffect","options","console","warn","_asyncToGenerator","_regeneratorRuntime","originalUri","_oktaUserAgent","addEnvironment","currentAuthState","handler","subscribe","start","unsubscribe","err","AuthSdkError","isAuthJsSupported","compareVersions","getVersion","minSupportedVersion","Provider","value","_onAuthRequired","withOktaAuth","ComponentToWrap","WrappedComponent","props","oktaAuthProps","displayName","LoginCallback","errorComponent","loadingElement","onAuthResume","callbackError","setCallbackError","ErrorReporter","isInteractionRequired","idx","bind","handleLoginRedirect","e","authError","displayError","useMatch","ReactRouterDom","SecureRoute","routeProps","_objectWithoutProperties","match","pendingLogin","useRef","handleLoginError","setHandleLoginError","handleLogin","current","toRelativeUrl","window","location","href","origin","setOriginalUri","onAuthRequiredFn","signInWithRedirect","isAuthenticated","Route"],"mappings":"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"}